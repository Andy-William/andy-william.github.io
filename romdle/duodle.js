import{wordleHash as t,calculate as e}from"./util.js";const n=["red","yellow","green"];document.getElementById("loadBtn").addEventListener("click",i),document.getElementById("solveBtn").addEventListener("click",(function(){const n=document.getElementById("solveBtn");document.getElementById("answercontainer").style.display="flex";const o=document.getElementById("results1"),l=document.getElementById("results2"),r=document.getElementById("suggestions");n.disabled=!0,n.textContent="Solving...",o.innerHTML="<p>Loading...</p>",l.innerHTML="<p>Loading...</p>",r.innerHTML="<p>Loading...</p>",setTimeout((()=>{(async function(){document.getElementById("grid1"),document.getElementById("grid2");const n=Array.from(document.getElementById("grid1").querySelectorAll(".row")),o=Array.from(document.getElementById("grid2").querySelectorAll(".row"));let l=[],r=[],i=[],a=[];n.forEach((t=>{let e="",n="";t.querySelectorAll(".tile").forEach(((t,o)=>{e+=t.textContent,n+=t.dataset.colorIndex})),l.push(e),i.push(n)})),o.forEach((t=>{let e="",n="";t.querySelectorAll(".tile").forEach(((t,o)=>{e+=t.textContent,n+=t.dataset.colorIndex})),r.push(e),a.push(n)})),await Promise.all(d);let u=c.filter((t=>t.trim())).map((t=>t.trim().toUpperCase())),g=s.filter((t=>t.trim())).map((t=>t.trim().toUpperCase()));var h=[...u],f=[...g];for(let e=0;e<i.length;e++)h=h.filter((n=>t(l[e],n)==i[e])),f=f.filter((n=>t(l[e],n)==i[e]));var p=[...u],y=[...g];for(let e=0;e<a.length;e++)p=p.filter((n=>t(r[e],n)==a[e])),y=y.filter((n=>t(r[e],n)==a[e]));class E{constructor(t,e,n,o,l){this.word=t,this.remaining1=Math.max(1,e,n),this.remaining2=Math.max(1,Math.min(e,n)),this.combination1=Math.max(o,l),this.combination2=Math.min(o,l)}static compare(t,e){return t.remaining2-e.remaining2||t.remaining1-e.remaining1||e.combination1*e.combination2-t.combination1*t.combination2}lte(t){return E.compare(this,t)<=0}lt(t){return E.compare(this,t)<=-1}toString(){return this.word+" - "+this.remaining1+"-"+this.remaining2+" - "+this.combination1+"-"+this.combination2}}function I(t,n,o){if(0==o.length)return[];let l=e(t,o),r=e(n,o),i=new Array(o.length);for(let t=0;t<o.length;t++)i[t]=new E(o[t],l[t][1],r[t][1],l[t][2],r[t][2]);return i=i.sort(((t,e)=>E.compare(t,e))),i}let x=[];1!=h.length||l.includes(h[0])||x.push(new E(h[0],0,0,0,0));1!=p.length||r.includes(p[0])||x.push(new E(p[0],0,0,0,0));console.log(x.map((t=>t.toString())));let w=new E("",99999,99999,0,0),B=I(h,p,[...new Set(h.concat(p))]);B.length>0&&(w=B[0]);B=B.filter((t=>t.lte(w))).filter((t=>!l.includes(t.word.substring(0,5)))),console.log(B);let v=I(h,p,u);v=v.filter((t=>t.lt(w))),v.length>0&&(w=v[0]);console.log(v.map((t=>t.toString())));let C=I(h,p,g);C=C.filter((t=>t.lt(w))),console.log(C.map((t=>t.toString())));let L=x.map((t=>t.word)).concat(C.map((t=>t.word))).concat(v.map((t=>t.word))).concat(B.map((t=>t.word)));L=[...new Set(L)];let S=document.getElementById("results1"),A=document.getElementById("results2");m(S,h),m(A,p),m(document.getElementById("suggestions"),L);const b=document.createElement("div"),M=new Set(h);b.textContent="Other words that fit: "+f.filter((t=>!M.has(t))).join(", "),b.classList.add("hint"),S.appendChild(b);const q=document.createElement("div"),H=new Set(p);q.textContent="Other words that fit: "+y.filter((t=>!H.has(t))).join(", "),q.classList.add("hint"),A.appendChild(q)})().then((()=>{n.disabled=!1,n.textContent="Solve"}))}),50)}));const o=new URLSearchParams(window.location.search),l=o.get("words")||"",r=o.get("colors")||"";if(l.length>0&&(document.getElementById("guesses").value=l.match(/.{1,5}/g).join("\n"),i(),r.length>0)){let t=Array.from(r);document.querySelectorAll(".row").forEach((e=>{e.querySelectorAll(".tile").forEach((e=>{let o=t.shift();o&&(e.dataset.colorIndex=o,n.forEach((t=>e.classList.remove(t))),e.classList.add(n[o]))}))}))}function i(){const t=document.getElementById("guesses").value.trim().toUpperCase(),e=t.replace(/[^a-zA-Z]+/g,"").match(/.{5}/g)?.filter((t=>5===t.length))||[],o=[document.getElementById("grid1"),document.getElementById("grid2")];for(let t of o){const o=[],l=[{},{},{},{},{}];t.querySelectorAll(".row").forEach((t=>{const e=Array.from(t.querySelectorAll(".tile"));o.push(e.map(((t,e)=>{if(l[e][t.textContent]=parseInt(t.dataset.colorIndex),0!=l[e][t.textContent])for(let e=0;e<5;e++)l[e][t.textContent]&&0!=l[e][t.textContent]||(l[e][t.textContent]=1);return{letter:t.textContent,colorIndex:parseInt(t.dataset.colorIndex)}})))})),t.innerHTML="",e.forEach(((e,r)=>{const i=document.createElement("div");i.classList.add("row");for(let c=0;c<5;c++){const s=document.createElement("div"),d=o?.[r]?.[c],m=d?.letter===e[c]?d.colorIndex:l[c][e[c]]||0;s.classList.add("tile",n[m]),s.textContent=e[c],s.dataset.colorIndex=m,s.addEventListener("click",(()=>{let o=(parseInt(s.dataset.colorIndex)+1)%n.length;a(t.id,c,e[c],o,r)})),i.appendChild(s)}t.appendChild(i)}))}document.getElementById("colorHint").style.display="",document.getElementById("previewGrid").style.display="",document.getElementById("solveBtn").style.display="block"}function a(t,e,o,l,r){const i=document.getElementById(t);Array.from(i.children).forEach(((t,i)=>{if(i<r)return;let a=t.children[e];a.textContent==o&&(a.dataset.colorIndex=l,n.forEach((t=>a.classList.remove(t))),a.classList.add(n[l]))}))}let c=[],s=[],d=[fetch("romdle.txt").then((t=>t.text())).then((t=>c=t.split("\n"))),fetch("words5.txt").then((t=>t.text())).then((t=>s=t.split("\n")))];function m(t,e){t.innerHTML="",e.forEach((e=>{const n=document.createElement("div");n.textContent=e,n.classList.add("suggestion"),n.addEventListener("click",(()=>{!function(t){const e=document.getElementById("guesses");e.value=e.value+"\n"+t,i()}(e)})),t.appendChild(n)}))}
