const t=["red","yellow","green"];document.getElementById("loadBtn").addEventListener("click",l),document.getElementById("solveBtn").addEventListener("click",(function(){const t=document.getElementById("solveBtn");document.getElementById("answercontainer").style.display="flex";const e=document.getElementById("results1"),n=document.getElementById("results2"),o=document.getElementById("suggestions");t.disabled=!0,t.textContent="Solving...",e.innerHTML="<p>Loading...</p>",n.innerHTML="<p>Loading...</p>",o.innerHTML="<p>Loading...</p>",setTimeout((()=>{(async function(){document.getElementById("grid1"),document.getElementById("grid2");const t=Array.from(document.getElementById("grid1").querySelectorAll(".row")),e=Array.from(document.getElementById("grid2").querySelectorAll(".row"));let n=[],o=[],l=[],r=[];t.forEach((t=>{let e="",o="";t.querySelectorAll(".tile").forEach(((t,n)=>{e+=t.textContent,o+=t.dataset.colorIndex})),n.push(e),l.push(o)})),e.forEach((t=>{let e="",n="";t.querySelectorAll(".tile").forEach(((t,o)=>{e+=t.textContent,n+=t.dataset.colorIndex})),o.push(e),r.push(n)})),await Promise.all(s);let d=i.filter((t=>t.trim())).map((t=>t.trim().toUpperCase())),m=c.filter((t=>t.trim())).map((t=>t.trim().toUpperCase())),u={};function g(t,e){if(t=t.toUpperCase(),e=e.toUpperCase(),u[t]&&u[t][e])return u[t][e];u[t]=u[t]||{};let n=[0,0,0,0,0],o={};for(let l=0;l<5;l++)t[l]==e[l]?n[l]=2:o[e[l]]=(o[e[l]]||0)+1;for(let l=0;l<5;l++)t[l]!=e[l]&&o[t[l]]&&o[t[l]]>0&&(o[t[l]]--,n[l]=1);return u[t][e]=n.join("")}var h=[...d],f=[...m];for(let t=0;t<l.length;t++)h=h.filter((e=>g(n[t],e)==l[t])),f=f.filter((e=>g(n[t],e)==l[t]));var p=[...d],y=[...m];for(let t=0;t<r.length;t++)p=p.filter((e=>g(o[t],e)==r[t])),y=y.filter((e=>g(o[t],e)==r[t]));function E(t,e){let n=new Array(e.length);for(let o=0;o<e.length;o++){n[o]=[e[o],0];let l={};for(let r=0;r<t.length;r++){let i=g(e[o],t[r]);l[i]=(l[i]||0)+1,"22222"==i&&l[i]--,l[i]>n[o][1]&&(n[o][1]=l[i])}n[o][2]=Object.keys(l).length}return n}class I{constructor(t,e,n,o,l){this.word=t,this.remaining1=Math.max(e,n),this.remaining2=Math.min(e,n),this.combination1=Math.max(o,l),this.combination2=Math.min(o,l)}static compare(t,e){return t.remaining1-e.remaining1||t.remaining2-e.remaining2||e.combination1*e.combination2-t.combination1*t.combination2}lte(t){return I.compare(this,t)<=0}lt(t){return I.compare(this,t)<=-1}toString(){return this.word+" - "+this.remaining1+"-"+this.remaining2+" - "+this.combination1+"-"+this.combination2}}function w(t,e,n){if(0==n.length)return[];let o=E(t,n),l=E(e,n),r=new Array(n.length);for(let t=0;t<n.length;t++)r[t]=new I(n[t],o[t][1],l[t][1],o[t][2],l[t][2]);return r=r.sort(((t,e)=>I.compare(t,e))),r}let x=[];1!=h.length||n.includes(h[0])||x.push(new I(h[0],0,0,0,0));1!=p.length||o.includes(p[0])||x.push(new I(p[0],0,0,0,0));console.log(x.map((t=>t.toString())));let B=new I("",99999,99999,0,0),C=w(h,p,[...new Set(h.concat(p))]);C.length>0&&(B=C[0]);C=C.filter((t=>t.lte(B))).filter((t=>!n.includes(t.word.substring(0,5)))),console.log(C);let v=w(h,p,d);v=v.filter((t=>t.lt(B))),v.length>0&&(B=v[0]);console.log(v.map((t=>t.toString())));let L=w(h,p,m);L=L.filter((t=>t.lt(B))),console.log(L.map((t=>t.toString())));let S=x.map((t=>t.word)).concat(L.map((t=>t.word))).concat(v.map((t=>t.word))).concat(C.map((t=>t.word)));S=[...new Set(S)];let A=document.getElementById("results1"),b=document.getElementById("results2");a(A,h),a(b,p),a(document.getElementById("suggestions"),S);const M=document.createElement("div"),q=new Set(h);M.textContent="Other words that fit: "+f.filter((t=>!q.has(t))).join(", "),M.classList.add("hint"),A.appendChild(M);const k=document.createElement("div"),H=new Set(p);k.textContent="Other words that fit: "+y.filter((t=>!H.has(t))).join(", "),k.classList.add("hint"),b.appendChild(k)})().then((()=>{t.disabled=!1,t.textContent="Solve"}))}),50)}));const e=new URLSearchParams(window.location.search),n=e.get("words"),o=e.get("colors");if(n.length>0&&(document.getElementById("guesses").value=n.match(/.{1,5}/g).join("\n"),l(),o.length>0)){let e=Array.from(o);document.querySelectorAll(".row").forEach((n=>{console.log(n),n.querySelectorAll(".tile").forEach((n=>{let o=e.shift();o&&(n.dataset.colorIndex=o,t.forEach((t=>n.classList.remove(t))),n.classList.add(t[o]))}))}))}function l(){const e=document.getElementById("guesses").value.trim().toUpperCase(),n=e.replace(/[^a-zA-Z]+/g,"").match(/.{5}/g)?.filter((t=>5===t.length))||[],o=[document.getElementById("grid1"),document.getElementById("grid2")];for(let e of o){const o=[],l=[{},{},{},{},{}];e.querySelectorAll(".row").forEach((t=>{const e=Array.from(t.querySelectorAll(".tile"));o.push(e.map(((t,e)=>{if(l[e][t.textContent]=parseInt(t.dataset.colorIndex),0!=l[e][t.textContent])for(let e=0;e<5;e++)l[e][t.textContent]&&0!=l[e][t.textContent]||(l[e][t.textContent]=1);return{letter:t.textContent,colorIndex:parseInt(t.dataset.colorIndex)}})))})),e.innerHTML="",n.forEach(((n,i)=>{const c=document.createElement("div");c.classList.add("row");for(let s=0;s<5;s++){const a=document.createElement("div"),d=o?.[i]?.[s],m=d?.letter===n[s]?d.colorIndex:l[s][n[s]]||0;a.classList.add("tile",t[m]),a.textContent=n[s],a.dataset.colorIndex=m,a.addEventListener("click",(()=>{let o=(parseInt(a.dataset.colorIndex)+1)%t.length;r(e.id,s,n[s],o,i)})),c.appendChild(a)}e.appendChild(c)}))}document.getElementById("colorHint").style.display="",document.getElementById("previewGrid").style.display="",document.getElementById("solveBtn").style.display="block"}function r(e,n,o,l,r){const i=document.getElementById(e);Array.from(i.children).forEach(((e,i)=>{if(i<r)return;let c=e.children[n];c.textContent==o&&(c.dataset.colorIndex=l,t.forEach((t=>c.classList.remove(t))),c.classList.add(t[l]))}))}let i=[],c=[],s=[fetch("romdle.txt").then((t=>t.text())).then((t=>i=t.split("\n"))),fetch("words5.txt").then((t=>t.text())).then((t=>c=t.split("\n")))];function a(t,e){t.innerHTML="",e.forEach((e=>{const n=document.createElement("div");n.textContent=e,n.classList.add("suggestion"),n.addEventListener("click",(()=>{!function(t){const e=document.getElementById("guesses");e.value=e.value+"\n"+t,l()}(e)})),t.appendChild(n)}))}
