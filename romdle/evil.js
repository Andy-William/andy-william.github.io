import{wordleHash as t,calculate as e,eligibleWord as n}from"./util.js";const i=5,r=6;let o=[],l=0,a=!1,s=[],c=[],m=[],d=[],u=[fetch("romdle.txt").then((t=>t.text())).then((t=>c=t.split("\n").filter((t=>t.trim())).map((t=>t.trim().toUpperCase())))),fetch("words5.txt").then((t=>t.text())).then((t=>m=t.split("\n").filter((t=>t.trim())).map((t=>t.trim().toUpperCase())))),fetch("evil.txt").then((t=>t.text())).then((t=>d=t.split("\n").filter((t=>t.trim())).map((t=>t.trim().toUpperCase()))))];const f=document.getElementById("board"),p=document.getElementById("guessInput");document.getElementById("resetBtn").addEventListener("click",g);const h=document.getElementById("errorSubmit");async function g(){l=0,a=!1,s=[],p.value="",p.focus(),h.textContent="",function(){f.innerHTML="";for(let t=0;t<r;t++){const e=document.createElement("div");e.className="row";for(let n=0;n<i;n++){const i=document.createElement("div");i.className="tile gray",i.textContent="",i.dataset.row=t,i.dataset.col=n,e.appendChild(i)}f.appendChild(e)}}(),await Promise.all(u),o=[...d]}class w{constructor(t,e,n){this.word=t,this.remaining=e,this.combination=n}static compare(t,e){return t.remaining-e.remaining||e.combination-t.combination}}function C(t,n){if(0==n.length)return[];let i=e(t,n);return i=i.map((t=>new w(t[0],t[1],t[2]))),i=i.sort(((t,e)=>w.compare(t,e))),i[0]}function x(e){if(a)return;if((e=e.toUpperCase()).length!==i)return void(h.textContent="Invalid word length!");if(!n(e,s))return void(h.textContent="Must contain "+Array.from(new Set(s)).join(", ")+"!");if(!m.includes(e)&&!c.includes(e))return void(h.textContent="Not in word list!");h.textContent="";const d=document.querySelectorAll(`.row:nth-child(${l+1}) .tile`);let u=function(e,i){let r={},a=0,d=new w("",-1,0),u="22222";for(let n of i){let i=t(e,n);r[i]||=[],r[i].push(n)}for(let t in r){if(r[t].length<a)continue;if("22222"==t)continue;let i=[];for(let n in t)"0"!=t[n]&&i.push(e[n]);let o=m.filter((t=>n(t.trim(),i))).map((t=>t.trim().toUpperCase())),l=C(r[t],o);(d.remaining<l.remaining||d.remaining==l.remaining&&r[t].length>r[u].length)&&(d=l,u=t,a=d.remaining,s=i)}return o=0==l?c.filter((n=>t(e,n)==u)):r[u],u}(e,o);for(let t=0;t<u.length;t++)d[t].textContent=e[t],d[t].classList.remove("red","yellow","green","gray"),"2"==u[t]?d[t].classList.add("green"):"1"==u[t]?d[t].classList.add("yellow"):d[t].classList.add("red");l++,"22222"==u?(a=!0,h.textContent="You win!"):l>=r&&(a=!0,h.textContent=`Game over! The word was ${o[0]}`),p.value=""}p.addEventListener("keydown",(t=>{"Enter"===t.key&&x(p.value)})),g();
